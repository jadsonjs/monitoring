# Monitoring Spring Boot Applications with Grafana


![alt text](https://github.com/jadsonjs/monitoring/blob/master/imgs/tools.png)


## Preparing a Spring Boot Application to Monitoring Metrics

We created a simple spring boot application adding the **actuator** and **prometheus** dependences


![alt text](https://github.com/jadsonjs/monitoring/blob/master/imgs/spring_dependences.png)


Actuator is a Java library that will generate the metrics about the spring boot application, like CPU usage, Memory, Up time, etc.. 

Micrometer Prometheus library will convert the data generated by actuator to prometheus format.

To run the application of this project, just import the project as a gradle project and run the MonitoringDemoApplication class

![alt text](https://github.com/jadsonjs/monitoring/blob/master/imgs/running_application.png)

As the actuator dependence is present in the project, we can access http://localhost:8080/actuator to have some information available.


![alt text](https://github.com/jadsonjs/monitoring/blob/master/imgs/actuator_metrics.png)

By default, just the **health** endpoint have free access.

We added the following line on application.properties, to expose all endpoints.

management.endpoints.web.exposure.include=*

The Actuator endpoints reveal sensitive information about the application. Anyone who has access to the actuator endpoint can know things like the Beans, properties configurations and other metrics about the application. Therefore, do not leave endpoints without protection.


For that, we define a spring security user name and password in application.properties file.

```

spring.security.user.name=prometheus
spring.security.user.password=$2a$10$KiJV109h9BQtFxwK.928ke9QKxRSuRwzHoCCsV4VceWeIXU8BU9Oa
spring.security.user.roles=ENDPOINT_ADMIN

```
And configure spring basic authentication in the SecurityConfig class.
```
protected void configure(HttpSecurity http) throws Exception {
        http
            .authorizeRequests().requestMatchers(EndpointRequest.toAnyEndpoint())
            .authenticated()
            .and()
            .httpBasic();
}

```